### Цель
Обновить LooP Learn (бывш. Loop Learning system) с новым «поездом» блоков: занять всю ширину, убрать горизонтальный скролл, улучшить ориентирование по первой строке блока и цвета, гарантировать корректную видимость поверх UI и режимов.

### Что изменилось
- **Поезд поверх всех слоёв**: портал в `document.body`, фиксированное позиционирование, высокий z-index.
- **Во всю ширину окна**: вагончики равномерно делят ширину, без горизонтального скролла.
- **Умное сокращение**: первая строка блока с обрезкой троеточием + полная строка в тултипе.
- **Тултип вверх**: подсказка появляется над вагоном, не перекрывая текст песни.
- **Цветовая кодировка**: приглушённые цвета для типов (куплет/припев/бридж) — элегантно, без «кислоты».
- **Кнопка Loop/Stop**: перемещена в правый нижний угол блока, не перекрывается «поездом».
- **Автоцентр активного вагона**: мягкая прокрутка к текущему блоку при смене.
- **Скрытие в каталоге**: «поезд» не виден при открытом каталоге; показывается только в репетиции.
- **Наблюдатели и очистка**: корректный lifecycle — resize/scroll/overlay observers и cleanup.

### Как тестировать
- **Репетиция**: открыть режим репетиции — «поезд» рисуется мгновенно, занимает всю ширину, цвета применены, длинные названия обрезаны, тултип вверх.
- **Каталог**: открыть каталог — «поезд» скрыт. Закрыть каталог — «поезд» появляется, структура вагонов соответствует треку.
- **Смена трека**: выбрать другой трек — «поезд» пересобирается в соответствии с блоками нового трека.
- **Навигация**: клик по вагону переводит к началу блока; активный вагон подсвечен и автоцентрируется.
- **Кнопка Loop/Stop**: всегда в правом нижнем углу блока, не перекрывается.

### Скриншоты
![](Docs/loop-learn/Снимок экрана 2025-08-14 в 13.54.53.png)
![](Docs/loop-learn/Снимок экрана 2025-08-14 в 16.20.14.png)
![](Docs/loop-learn/Снимок экрана 2025-08-14 в 16.20.32.png)
![](Docs/loop-learn/Снимок экрана 2025-08-14 в 16.20.40.png)
![](Docs/loop-learn/Снимок экрана 2025-08-14 в 16.20.49.png)

### Известные моменты (не блокеры)
- Небольшой «прыжок» поезда при возврате назад — зафиксировано, план фикса < 1 часа.

### Next steps
- Подсветка вагонов по типу (по стабильным правилам имени/метаданных).
- Сохранение пользовательских границ лупа per-блок (IndexedDB, ключ `trackId+blockId`).
- Микро-анимации и hover-эффекты на вагончиках (без потери производительности).


