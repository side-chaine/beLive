## Stage 1: PR‑B — Lifecycle & Cleanup
**Goal**: Ввести единый жизненный цикл (`init/activate/deactivate/dispose`) для основных модулей: `js/block-loop-control.js`, `js/lyrics-display.js`, `js/audio-engine.js`, `js/catalog-v2.js`, `js/app.js` (точки активации), убрать утечки слушателей/обсерверов, добавить метрики.
**Success Criteria**:
- Все перечисленные модули имеют методы lifecycle и корректно освобождают ресурсы.
- Отсутствуют дублирующиеся обработчики после многократных открытий/закрытий каталога/режимов.
- Добавлены `performance.mark/measure` по ключевым операциям загрузки трека и рендеринга текста (в логи).
**Tests**:
- Smoke: 10 циклов «открыть каталог → проиграть трек → сменить режим → вернуться» без роста слушателей/обсерверов (проверка через логи).
- Проверка, что `before-track-change` приводит к `deactivate()` нужных компонентов.
**Status**: Not Started

## Stage 2: PR‑C — LooP Learn UX/Perf полиш
**Goal**: Полировка «поезда»: авто‑центр активного вагона, тултипы сверху, минимальная высота и растяжение на всю ширину, стабильная позиция при смене режимов, дебаунс/троттлинг событий.
**Success Criteria**:
- Вагон всегда в видимой зоне, по центру ±10% от ширины контейнера.
- Тултипы не перекрывают текст, появляются сверху.
- Без визуальных «прыжков» при переходах режимов (концерт/караоке/репетиция/синк).
- Отсутствуют jank/лаг в логах (разовые RAF, троттлинг 16–33ms для scroll/resize).
**Tests**:
- Smoke: 20 переключений блоков подряд — без смещений/скролла в неправильную сторону.
- Включение/выключение Sync Editor не ломает авто‑центр.
**Status**: Not Started

## Stage 3: Waveform/Vocal Pipeline Stabilization
**Goal**: Убрать «WaveformEditor: Vocal audio data not available»; унифицировать безопасные URL и моменты подключения MediaElementSource.
**Success Criteria**:
- `WaveformEditor` ждёт `loadedmetadata`/`canplay` и использует уже подготовленные safe `data:` URL из `AudioEngine`.
- Вокал подключается 1 раз, дальнейшие треки не создают дубликаты нод.
- Логи без повторяющегося предупреждения при нормальной загрузке.
**Tests**:
- Smoke: 5 последовательных треков из плейлиста — без ошибок и дерганий.
**Status**: Not Started

## Stage 4: Rehearsal Enhancements (BPM/Loop UI)
**Goal**: Управление скоростью и границами петли с дружелюбным UI.
**Success Criteria**:
- Слайдер границ (noUiSlider) в репетиции с визуальной привязкой к блоку.
- Кнопки скорости (−10%, −5%, +5%, +10%), без артефактов питча на базе текущей архитектуры.
**Tests**:
- Smoke: переход между скоростями во время лупа без рассинхронизаций.
**Status**: Not Started
