# üéØ –ü–õ–ê–ù –ò–ù–¢–ï–ì–†–ê–¶–ò–ò –ò–°–ü–†–ê–í–õ–ï–ù–ù–û–ô –ù–ê–í–ò–ì–ê–¶–ò–ò –ü–û –ù–û–¢–ê–ú

## üö® –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

1. **–ó–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ pitch-–∫–∞—Ä—Ç—ã –ø–æ–¥—ä–µ–∑–¥–∞–º–∏** - –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –¥–µ—Ç–µ–∫—Ü–∏–∏, –≤–∫–ª—é—á–∞—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
2. **–ü—Ä–æ—Å—Ç–∞—è –≤—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è** - –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –Ω–æ—Ç
3. **–ê—Å–∏–º–º–µ—Ç—Ä–∏—è –¥–≤–∏–∂–µ–Ω–∏—è** - –≤–ø–µ—Ä–µ–¥/–Ω–∞–∑–∞–¥ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ-—Ä–∞–∑–Ω–æ–º—É
4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏** - –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –Ω–æ—Ç—ã

## üìã –≠—Ç–∞–ø—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:

### –≠—Ç–∞–ø 1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –∫–∞—Ä—Ç—É
```javascript
// –í –º–µ—Ç–æ–¥–µ processNoteWithAccuracyTracking –∑–∞–º–µ–Ω–∏—Ç—å:
this.recordToPitchMap(keyId, pitchData);
// –ù–ê:
this.recordToPitchMapFixed(keyId, pitchData);
```

### –≠—Ç–∞–ø 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
```javascript
// –í –º–µ—Ç–æ–¥–µ performScrubStep –∑–∞–º–µ–Ω–∏—Ç—å:
this.scrubByPitchMap(direction);
// –ù–ê:
this.scrubByPitchMapFixed(direction);
```

### –≠—Ç–∞–ø 3: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—á–∏—Å—Ç–∫–∏ –∫–∞—Ä—Ç—ã
```javascript
// –í –º–µ—Ç–æ–¥ hide() –¥–æ–±–∞–≤–∏—Ç—å:
if (this.pitchMap.notes.length > 0) {
    this.cleanupPitchMap();
}
```

### –≠—Ç–∞–ø 4: –ó–∞—â–∏—Ç–∞ —Å–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –Ω–æ—Ç
```javascript
// –í –º–µ—Ç–æ–¥ cleanupInactiveKeysConditional –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É:
if (noteData.protectedFromCleanup || noteData.fromCleanMap) {
    console.log(`üõ°Ô∏è –°–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–æ—Ç–∞ ${keyId} –∑–∞—â–∏—â–µ–Ω–∞ –æ—Ç –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∏`);
    continue; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –æ—á–∏—Å—Ç–∫—É
}
```

## üîß –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ:

### 1. –°—Ç—Ä–æ–∫–∞ ~865 (processNoteWithAccuracyTracking):
```javascript
// –ë–´–õ–û:
this.recordToPitchMap(keyId, pitchData);

// –°–¢–ê–õ–û:
this.recordToPitchMapFixed(keyId, pitchData);
```

### 2. –°—Ç—Ä–æ–∫–∞ ~1660 (performScrubStep):
```javascript
// –ë–´–õ–û:
this.scrubByPitchMap(direction);

// –°–¢–ê–õ–û:
this.scrubByPitchMapFixed(direction);
```

### 3. –°—Ç—Ä–æ–∫–∞ ~1780 (simulateNoteFromPitchMap):
```javascript
// –ë–´–õ–û:
this.simulateNoteFromPitchMap(targetNote);

// –°–¢–ê–õ–û:
this.simulateNoteFromPitchMapFixed(targetNote);
```

### 4. –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω–µ—Ü –∫–ª–∞—Å—Å–∞ –≤—Å–µ –º–µ—Ç–æ–¥—ã –∏–∑ piano-keyboard-fixed.js

## üß™ –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–ó–∞–ø–∏—Å—å –Ω–æ—Ç** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ–¥—ä–µ–∑–¥—ã –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è
2. **–ù–∞–≤–∏–≥–∞—Ü–∏—è –Ω–∞–∑–∞–¥** - –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ—á–Ω–æ –∫–∞–∫ —Ä–∞–Ω—å—à–µ
3. **–ù–∞–≤–∏–≥–∞—Ü–∏—è –≤–ø–µ—Ä–µ–¥** - –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–æ—Ç—ã
4. **–°–∏–º–º–µ—Ç—Ä–∏—è** - –¥–≤–∏–∂–µ–Ω–∏–µ –≤–ø–µ—Ä–µ–¥-–Ω–∞–∑–∞–¥ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–±—Ä–∞—Ç–∏–º—ã–º
5. **–ö–∞—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç—ã** - –≤ –∫–∞—Ä—Ç–µ –¥–æ–ª–∂–Ω—ã –æ—Å—Ç–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ —á–∏—Å—Ç—ã–µ –Ω–æ—Ç—ã

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ:

- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –Ω–∞–∑–∞–¥ (–æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–ª–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ)
- –ò—Å–∫–ª—é—á–∏—Ç—å –ø–æ–¥—ä–µ–∑–¥—ã –∏–∑ –∑–∞–ø–∏—Å–∏ –≤ –∫–∞—Ä—Ç—É
- –û–±–µ—Å–ø–µ—á–∏—Ç—å —Å–∏–º–º–µ—Ç—Ä–∏—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –≤–ø–µ—Ä–µ–¥/–Ω–∞–∑–∞–¥
- –ó–∞—â–∏—Ç–∏—Ç—å —Å–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–æ—Ç—ã –æ—Ç –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∏

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –Ω–∞–∑–∞–¥: —Ç–æ—á–Ω–æ —Ç–µ –∂–µ –Ω–æ—Ç—ã —á—Ç–æ –±—ã–ª–∏ —Å—ã–≥—Ä–∞–Ω—ã
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤–ø–µ—Ä–µ–¥: —Ç–æ—á–Ω–æ —Ç–µ –∂–µ –Ω–æ—Ç—ã —á—Ç–æ –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –Ω–∞–∑–∞–¥  
- Pitch-–∫–∞—Ä—Ç–∞: —Ç–æ–ª—å–∫–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–æ—Ç—ã
- –ü–æ–¥—ä–µ–∑–¥—ã: –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ –∫–∞—Ä—Ç—ã –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ 