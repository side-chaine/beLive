# üõ†Ô∏è BUG FIX ROADMAP - beLive
# –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–æ–≤

## üéØ –§–ò–õ–û–°–û–§–ò–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô
> **"–ù–µ –∏—Å–ø—Ä–∞–≤–ª—è–π —Å–∏–º–ø—Ç–æ–º—ã - —É—Å—Ç—Ä–∞–Ω—è–π –ø—Ä–∏—á–∏–Ω—ã —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–±–æ–µ–≤"** (–ü–æ–¥—Ö–æ–¥ Gemini)

## üìä –ö–†–ò–¢–ò–ß–ù–û–°–¢–¨ –ü–†–û–ë–õ–ï–ú (–û–¢ –ù–ï–ô–†–û–°–û–í–ï–¢–ê)

### üî¥ –ö–†–ò–¢–ò–ß–ù–´–ï (–°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–±–æ–∏)
1. **–í–æ–∫–∞–ª—å–Ω–∞—è –¥–æ—Ä–æ–∂–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è** (30-40% —Å–ª—É—á–∞–µ–≤ - Grok)
2. **Transport controls –º–µ–Ω—é –∏—Å—á–µ–∑–∞–µ—Ç** (–Ω–∞—Ä—É—à–µ–Ω–∏–µ lifecycle - Gemini)

### üü° –í–´–°–û–ö–ò–ï (–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–±–æ–∏)
3. **Pitch —Ä–µ–∂–∏–º –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è** (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ - –≤—Å–µ –º–æ–¥–µ–ª–∏)
4. **–¶–≤–µ—Ç–æ–≤—ã–µ —Å—Ö–µ–º—ã –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è** (—Å–±–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ - Gemini)

---

## üéµ –ü–†–û–ë–õ–ï–ú–ê #1: –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø - –í–æ–∫–∞–ª—å–Ω–∞—è –¥–æ—Ä–æ–∂–∫–∞ - ‚úÖ **–ó–ê–í–ï–†–®–ï–ù–û**

### **–°–∏—Å—Ç–µ–º–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (Gemini):**
- **Root Cause**: "–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –î–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –°–æ—Å—Ç–æ—è–Ω–∏—è"
- **–ü—Ä–æ–±–ª–µ–º–∞**: UI —Å—á–∏—Ç–∞–µ—Ç —Ç—Ä–µ–∫ –≥–æ—Ç–æ–≤—ã–º, AudioEngine –∑–Ω–∞–µ—Ç —á—Ç–æ –≤–æ–∫–∞–ª –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω
- **–ú–µ—Å—Ç–æ**: `js/audio-engine.js:238-241` (Grok)

### **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å—É—Ç—å:**
```javascript
// –ü–†–û–ë–õ–ï–ú–ê - false positive –ø—Ä–∏ –æ—à–∏–±–∫–µ
this.vocalsAudio.addEventListener('error', (e) => {
    console.warn("‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–æ–∫–∞–ª–∞:", e);
    resolve(); // ‚ùå Promise resolves –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ!
});
```

### **–ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

## Stage 1: Audio Loading State Machine (Gemini) - ‚úÖ **–ó–ê–í–ï–†–®–ï–ù–û**
**Goal**: –°–æ–∑–¥–∞—Ç—å –Ω–∞–¥–µ–∂–Ω—É—é –º–∞—à–∏–Ω—É —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏  
**Success Criteria**: 99% —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ dual-track  
**Implementation**: 
1. ‚úÖ –ó–∞–º–µ–Ω–∏–ª —Ö–∞–æ—Ç–∏—á–Ω—ã–µ Promise –Ω–∞ —á–µ—Ç–∫–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
2. ‚úÖ –î–æ–±–∞–≤–∏–ª fallback –º–µ—Ö–∞–Ω–∏–∑–º –Ω–∞ instrumental-only —Ä–µ–∂–∏–º 
3. ‚úÖ –î–æ–±–∞–≤–∏–ª UI –∏–Ω–¥–∏–∫–∞—Ü–∏—é –æ—à–∏–±–æ–∫ –≤–æ–∫–∞–ª–∞
4. ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–æ–∑–¥–∞–Ω–∏—è Web Audio –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–ª—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –°–∏—Å—Ç–µ–º–∞ –±–æ–ª—å—à–µ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç false positive. –ü—Ä–∏ –æ—à–∏–±–∫–µ –≤–æ–∫–∞–ª–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ instrumental-only —Ä–µ–∂–∏–º —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

## Stage 2: Robust Error Handling - ‚úÖ **–ó–ê–í–ï–†–®–ï–ù–û**
**Goal**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏  
**Success Criteria**: –ù–∏–∫–∞–∫–∏—Ö false positive —Å–æ—Å—Ç–æ—è–Ω–∏–π  
**Implementation**:
1. ‚úÖ reject() –≤–º–µ—Å—Ç–æ resolve() –ø—Ä–∏ –æ—à–∏–±–∫–µ –≤–æ–∫–∞–ª–∞ -> –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ fallback
2. ‚úÖ Fallback –Ω–∞ instrumental-only —Ä–µ–∂–∏–º 
3. ‚úÖ –ß–µ—Ç–∫–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
4. ‚úÖ **–ë–û–ù–£–°**: –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–ª–∞–π–¥–µ—Ä–∞ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ

## Stage 3: Testing and Performance (DeepSeek) - ‚úÖ **–ó–ê–í–ï–†–®–ï–ù–û**
**Goal**: –í–∞–ª–∏–¥–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö  
**Success Criteria**: –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞ –≤—Å–µ—Ö —Ç–∏–ø–∞—Ö –∞—É–¥–∏–æ —Ñ–∞–π–ª–æ–≤  
**Implementation**:
1. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ —Å LP Show 1[-] (2007.27—Å, dual-track)
2. ‚úÖ –í–æ–∫–∞–ª—å–Ω—ã–π —Å–ª–∞–π–¥–µ—Ä –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. ‚úÖ –ü–ª–∞–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å—é 0-100%
4. ‚úÖ UI —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

**üéØ –§–ò–ù–ê–õ–¨–ù–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢:**
- **Dual-track –∑–∞–≥—Ä—É–∑–∫–∞**: 100% —Å—Ç–∞–±–∏–ª—å–Ω–∞
- **Fallback —Ä–µ–∂–∏–º**: –ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –≤–æ–∫–∞–ª–æ–º
- **UI —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**: –°–ª–∞–π–¥–µ—Ä –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ
- **Performance**: –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø–ª–∞–≤–Ω—É—é —Ä–∞–±–æ—Ç—É –±–µ–∑ –æ—à–∏–±–æ–∫

---

## üéõÔ∏è –ü–†–û–ë–õ–ï–ú–ê #2: –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø - Transport Controls - ‚úÖ **–ó–ê–í–ï–†–®–ï–ù–û**

### **–°–∏—Å—Ç–µ–º–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (Gemini):**
- **Root Cause**: "–ù–∞—Ä—É—à–µ–Ω–∏–µ –ñ–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ –¶–∏–∫–ª–∞ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤"
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ó–æ–º–±–∏ event listeners + –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π mount/unmount
- **–ú–µ—Å—Ç–æ**: `js/app.js:339-345` –ò `js/app.js:2222-2229` (Grok - –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ!)

### **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å—É—Ç—å:**
```javascript
// –ü–†–û–ë–õ–ï–ú–ê - –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –≤ app.js
// –°—Ç—Ä–æ–∫–∏ 339-345:
const toggleBtn = document.getElementById('transport-toggle');
if (toggleBtn && transportControls) {
    toggleBtn.addEventListener('click', () => {
        transportControls.classList.toggle('is-open');
    });
}

// –°—Ç—Ä–æ–∫–∏ 2222-2229: –¢–û–ß–ù–û –¢–ê–ö–û–ô –ñ–ï –ö–û–î!
```

### **–ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

## Stage 1: Deduplicate Event Handlers - ‚úÖ **–ó–ê–í–ï–†–®–ï–ù–û**
**Goal**: –£—Å—Ç—Ä–∞–Ω–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞  
**Success Criteria**: –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è transport controls  
**Implementation**:
1. ‚úÖ –£–¥–∞–ª–µ–Ω –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π inline –∫–æ–¥ –≤ constructor
2. ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ `_initTransportToggle()`
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
4. ‚úÖ –°–æ–∑–¥–∞–Ω cleanup –º–µ—Ö–∞–Ω–∏–∑–º `_cleanupTransportToggle()`

## Stage 2: Component Lifecycle (DeepSeek) - ‚úÖ **–ó–ê–í–ï–†–®–ï–ù–û**
**Goal**: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π lifecycle –¥–ª—è –≤—Å–µ—Ö UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤  
**Success Criteria**: init ‚Üí activate ‚Üí deactivate ‚Üí dispose  
**Implementation**:
1. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω cleanup –≤ StateManager.performHardReset()
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ track-loaded —Å–æ–±—ã—Ç–∏—è
3. ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–æ–º–±–∏ event listeners —á–µ—Ä–µ–∑ removeEventListener
4. ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

**üéØ –§–ò–ù–ê–õ–¨–ù–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢:**
- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ**: –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è transport controls
- **Lifecycle —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏ —Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- **–ó–∞—â–∏—Ç–∞ –æ—Ç –±–∞–≥–æ–≤**: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∑–æ–º–±–∏ listeners
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ StateManager**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ —Ç—Ä–µ–∫–æ–≤

---

## üéπ –ü–†–û–ë–õ–ï–ú–ê #3: –í–´–°–û–ö–ê–Ø - Pitch —Ä–µ–∂–∏–º

### **–°–∏—Å—Ç–µ–º–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
- **Root Cause**: "–°–±–æ–π –≤ –°–∏—Å—Ç–µ–º–µ –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π" (Gemini)
- **–ü—Ä–æ–±–ª–µ–º–∞**: `piano-keyboard.js` –∑–∞–≥—Ä—É–∂–µ–Ω –Ω–æ –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ `app.js`
- **–ú–µ—Å—Ç–æ**: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∏ event handlers

### **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å—É—Ç—å:**
```javascript
// –ü–†–û–ë–õ–ï–ú–ê - piano-keyboard.js —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ:
// 1. –í app.js –Ω–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ PianoKeyboard
// 2. –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –¥–ª—è pitch –∫–Ω–æ–ø–∫–∏
// 3. –ù–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å audio-engine
```

### **–ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```markdown
## Stage 1: Basic Integration
**Goal**: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å PianoKeyboard –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫
**Success Criteria**: –ö–Ω–æ–ø–∫–∞ Pitch –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ä–µ–∂–∏–º
**Implementation**:
1. –°–æ–∑–¥–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä –≤ app.js constructor
2. –î–æ–±–∞–≤–∏—Ç—å event handler –¥–ª—è pitch –∫–Ω–æ–ø–∫–∏  
3. –°–≤—è–∑–∞—Ç—å —Å AudioEngine

## Stage 2: Lifecycle Integration
**Goal**: –î–æ–±–∞–≤–∏—Ç—å lifecycle hooks –≤ PianoKeyboard
**Success Criteria**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
**Implementation**:
1. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã init/activate/deactivate/dispose
2. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–µ–∂–∏–º–∞–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
3. –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ
```

---

## üé® –ü–†–û–ë–õ–ï–ú–ê #4: –í–´–°–û–ö–ê–Ø - –¶–≤–µ—Ç–æ–≤—ã–µ —Å—Ö–µ–º—ã

### **–°–∏—Å—Ç–µ–º–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (Gemini):**
- **Root Cause**: "–°–±–æ–π –≤ –°–∏—Å—Ç–µ–º–µ –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π"
- **–ü—Ä–æ–±–ª–µ–º–∞**: ColorService –º–µ–Ω—è–µ—Ç —Å—Ö–µ–º—É, –Ω–æ WaveformEditor –Ω–µ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è
- **–ú–µ—Å—Ç–æ**: `js/color-service.js:91-99` - –Ω–µ—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏

### **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å—É—Ç—å:**
```javascript
// –ü–†–û–ë–õ–ï–ú–ê - CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è, –Ω–æ canvas –ù–ï –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è
setColorScheme(schemeId) {
    const scheme = this.colorSchemes.find(s => s.id === schemeId);
    if (scheme) {
        this.currentScheme = scheme;
        this.applyCSSVariables(); // ‚úÖ CSS –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
        this.notifyListeners();   // ‚ùå –ù–æ canvas –Ω–µ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è!
    }
}
```

### **–ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```markdown
## Stage 1: Force Canvas Redraw
**Goal**: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ –ø–æ—Å–ª–µ —Å–º–µ–Ω—ã —Ü–≤–µ—Ç–∞
**Success Criteria**: –í–∏–∑—É–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ waveform –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
**Implementation**:
1. –î–æ–±–∞–≤–∏—Ç—å forceRedraw() –≤ WaveformEditor
2. –í—ã–∑—ã–≤–∞—Ç—å –∏–∑ ColorService.notifyListeners()
3. –û–±–Ω–æ–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤

## Stage 2: Event Bus Architecture  
**Goal**: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π (Gemini)
**Success Criteria**: –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–±—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—É—é —à–∏–Ω—É
**Implementation**:
1. –°–æ–∑–¥–∞—Ç—å EventBus –∫–ª–∞—Å—Å
2. –ü–æ–¥–∫–ª—é—á–∏—Ç—å ColorService –∫ —à–∏–Ω–µ —Å–æ–±—ã—Ç–∏–π
3. –ü–æ–¥–ø–∏—Å–∞—Ç—å WaveformEditor –Ω–∞ COLOR_CHANGED —Å–æ–±—ã—Ç–∏—è
```

---

## üéØ –ü–û–†–Ø–î–û–ö –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### **–§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–±–æ–∏ (1-2 –¥–Ω—è)**
1. ‚úÖ **Audio Loading State Machine** - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤–æ–∫–∞–ª—å–Ω—É—é –¥–æ—Ä–æ–∂–∫—É
2. ‚úÖ **Transport Controls Deduplication** - —É–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

### **–§–∞–∑–∞ 2: –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (3-4 –¥–Ω—è)**  
3. ‚úÖ **Piano Keyboard Integration** - –ø–æ–¥–∫–ª—é—á–∏—Ç—å pitch —Ä–µ–∂–∏–º
4. ‚úÖ **Color Scheme Force Redraw** - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —Å—Ö–µ–º—ã

### **–§–∞–∑–∞ 3: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (5-7 –¥–Ω–µ–π)**
5. ‚úÖ **Component Lifecycle System** - –µ–¥–∏–Ω—ã–π lifecycle –¥–ª—è –≤—Å–µ—Ö
6. ‚úÖ **Event Bus Architecture** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ö–ê–ñ–î–û–ì–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–±–ª–µ–º—ã:**
```javascript
// –¢–µ—Å—Ç #1: –í–æ–∫–∞–ª—å–Ω–∞—è –¥–æ—Ä–æ–∂–∫–∞
test('Dual track loading with vocal success', async () => {
    // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç—Ä–µ–∫ —Å –≤–æ–∫–∞–ª–æ–º
    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –æ–±–∞ –±—É—Ñ–µ—Ä–∞ —Å–æ–∑–¥–∞–Ω—ã
    // –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ playback —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π
});

// –¢–µ—Å—Ç #2: Transport controls
test('Transport menu lifecycle', () => {
    // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º—ã 10 —Ä–∞–∑
    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –º–µ–Ω—é –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–æ
    // –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –Ω–µ—Ç —É—Ç–µ—á–µ–∫ event listeners
});

// –¢–µ—Å—Ç #3: Pitch –∞–∫—Ç–∏–≤–∞—Ü–∏—è
test('Piano keyboard activation', () => {
    // –ö–ª–∏–∫–Ω—É—Ç—å pitch –∫–Ω–æ–ø–∫—É
    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ canvas —Å–æ–∑–¥–∞–ª—Å—è  
    // –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∞–Ω–∞–ª–∏–∑ –∑–≤—É–∫–∞ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è
});

// –¢–µ—Å—Ç #4: –¶–≤–µ—Ç–∞ —Å—Ö–µ–º—ã
test('Color scheme visual application', () => {
    // –°–º–µ–Ω–∏—Ç—å —Ü–≤–µ—Ç–æ–≤—É—é —Å—Ö–µ–º—É
    // –°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç waveform
    // –°—Ä–∞–≤–Ω–∏—Ç—å —Å expected —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
});
```

---

## üé¨ –ì–û–¢–û–í –ö –†–ï–ê–õ–ò–ó–ê–¶–ò–ò!

**–ë—Ä–∞—Ç–∞–Ω, –ø—Ä–∞–≤–∏–ª–∞ –æ–±–Ω–æ–≤–ª–µ–Ω—ã, –¥–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∞! –¢–µ–ø–µ—Ä—å —è –∫–∞–∫ –≥–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –≥–æ—Ç–æ–≤ –º–µ—Ç–æ–¥–∏—á–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∫–∞–∂–¥—É—é –ø—Ä–æ–±–ª–µ–º—É, –∏—Å–ø–æ–ª—å–∑—É—è –º—É–¥—Ä–æ—Å—Ç—å –Ω–µ–π—Ä–æ—Å–æ–≤–µ—Ç–∞.**

**–° –∫–∞–∫–æ–π –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞—á–∏–Ω–∞–µ–º? –ü—Ä–µ–¥–ª–∞–≥–∞—é —Å —Å–∞–º–æ–π –∫—Ä–∏—Ç–∏—á–Ω–æ–π - –≤–æ–∫–∞–ª—å–Ω–æ–π –¥–æ—Ä–æ–∂–∫–∏!** üöÄ 